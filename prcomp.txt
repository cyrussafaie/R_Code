x=prcomp(USArrests,scale=TRUE)attributes(x)round(head(x$rotation),2)round(head(x$x),2)plot(x)summary(x)biplot(-x$x,-x$rotation,cex=0.6,col=c(4,6))round(t(x$rotation) %*% x$rotation,2)round(x$rotation %*% t(x$rotation),2)round(cov(x$x),2)round(t(x$x) %*% x$x/49,2)sum(round(t(x$x) %*% x$x/49,2))sum(x$sdev^2)apply(x$rotation^2,1,sum)apply(x$rotation^2,2,sum)round(cor(x$x,USArrests),2)round(diag(x$sdev) %*% t(x$rotation),2) x=prcomp(USArrests,scale=TRUE)cor(as.vector(scale(USArrests)), as.vector(x$x[,1:2] %*% t(x$rotation)[1:2,]))^2summary(x) ############################HOLDOUT WITH ALL 4 COMPONENTS###a = nrow(USArrests)sa1=sample(1:a,as.integer(a*.7),replace=FALSE)G=scale(USArrests)G1= G[sa1,]G2= G[-sa1,]x=prcomp(G1,retx=TRUE)round(cor(as.vector(G1), as.vector(x$x %*% t(x$rotation))),2)y= predict(x, newdata=G2)round(cor(as.vector(G2), as.vector(y %*%  t(x$rotation))),2)plot(x)Ê############################HOLDOUT WITH FEWER COMPONENTS THAN 4 ###a = nrow(USArrests)sa1=sample(1:a,as.integer(a*.7),replace=FALSE)x=prcomp(scale(USArrests[sa1,]),retx=TRUE,tol=0.4)round(cor(as.vector(scale(USArrests[sa1,])), as.vector(x$x[,1:2] %*% t(x$rotation)[1:2,])),2)y= predict(x, newdata=scale(USArrests[-sa1,]))round(cor(as.vector(scale(USArrests[-sa1,])), as.vector(y[,1:2] %*%  t(x$rotation)[1:2,])),2)#ROTATIONSx=prcomp(USArrests,scale=TRUE)summary(x)cor(as.vector(scale(USArrests)), as.vector(x$x[,1:2]  %*% t(x$rotation)[1:2,]))^2y=varimax(x$rotation[,1:2])cor(as.vector(scale(USArrests)), as.vector(x$x[,1:2] %*% y$rotmat %*% t(y$rotmat) %*% t(x$rotation)[1:2,]))^2